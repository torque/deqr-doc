<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Decoders" href="decoders.html" /><link rel="prev" title="deqr 0.2.1.post5+9554c86" href="index.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.09.29"/>
        <title>Getting Started - deqr</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">deqr</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">deqr</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="decoders.html">Decoders</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development.html">How-To</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/torque/deqr">Git Repository</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/torque/deqr/issues">Bug Tracker</a></li>
</ul>

</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">#</a></h1>
<p>If you already have an image containing a QR code that you’d like to decode, the
process is pretty straightforward.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">deqr</span></code> is published on PyPi with pre-built binaries for common platforms and
modern Python versions. It can be installed with <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">deqr</span>
</pre></div>
</div>
</section>
<section id="a-basic-exmaple">
<h2>A Basic Exmaple<a class="headerlink" href="#a-basic-exmaple" title="Permalink to this headline">#</a></h2>
<section id="decoding-from-an-image">
<h3>Decoding From an Image<a class="headerlink" href="#decoding-from-an-image" title="Permalink to this headline">#</a></h3>
<p>The easiest way to decode QR codes from an image file is to use the external
<a class="reference external" href="https://github.com/opencv/opencv">OpenCV</a> or <a class="reference external" href="https://github.com/python-pillow/Pillow">Pillow</a> libraries. These libraries are not shipped as dependencies
of <code class="docutils literal notranslate"><span class="pre">deqr</span></code>, so you have to manually install whichever one you want to use.</p>
<p>Given the following image, which is a directly generated image and therefore
ideal for decoding:</p>
<figure class="align-center">
<img alt="/deqr-docs/images/amalgam.png" src="/deqr-docs/images/amalgam.png" />
</figure>
<p>This image contains codes with data in the four basic types: numeric,
alphanumeric, byte, and kanji.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">OpenCV</label><div class="tab-content docutils container">
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">QRdec</label><div class="tab-content docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">deqr</span>

<span class="n">image_data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;amalgam.png&quot;</span><span class="p">)</span>

<span class="n">decoder</span> <span class="o">=</span> <span class="n">deqr</span><span class="o">.</span><span class="n">QRdecDecoder</span><span class="p">()</span>

<span class="n">decoded_codes</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Quirc</label><div class="tab-content docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">deqr</span>

<span class="n">image_data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;amalgam.png&quot;</span><span class="p">)</span>

<span class="n">decoder</span> <span class="o">=</span> <span class="n">deqr</span><span class="o">.</span><span class="n">QuircDecoder</span><span class="p">()</span>

<span class="n">decoded_codes</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Pillow</label><div class="tab-content docutils container">
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">QRdec</label><div class="tab-content docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PIL.Image</span><span class="o">,</span> <span class="nn">PIL.ImageDraw</span><span class="o">,</span> <span class="nn">PIL.ImageFont</span>
<span class="kn">import</span> <span class="nn">deqr</span>

<span class="n">image_data</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;amalgam.png&quot;</span><span class="p">)</span>

<span class="n">decoder</span> <span class="o">=</span> <span class="n">deqr</span><span class="o">.</span><span class="n">QRdecDecoder</span><span class="p">()</span>

<span class="n">decoded_codes</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Quirc</label><div class="tab-content docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PIL.Image</span><span class="o">,</span> <span class="nn">PIL.ImageDraw</span><span class="o">,</span> <span class="nn">PIL.ImageFont</span>
<span class="kn">import</span> <span class="nn">deqr</span>

<span class="n">image_data</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;amalgam.png&quot;</span><span class="p">)</span>

<span class="n">decoder</span> <span class="o">=</span> <span class="n">deqr</span><span class="o">.</span><span class="n">QuircDecoder</span><span class="p">()</span>

<span class="n">decoded_codes</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>deqr attempts to have sane defaults for data conversion while providing the
user with sufficient flexibility to deal with nonstandard QR codes or those
created with domain-specific data encoding. See
the <a class="reference internal" href="api-reference.html#deqr.QRdecDecoder.decode" title="deqr.QRdecDecoder.decode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">deqr.QRdecDecoder.decode()</span></code></a> documentation for more information
about how data conversion is performed.</p>
</div>
<p>These examples have virtually identical outputs (the bounding box computation
varies slightly between the decoders, and the ordering of the output list isn’t
guaranteed to be consistent between the two):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">decoded_codes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">QRCode</span><span class="p">(</span>
        <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">ecc_level</span><span class="o">=</span><span class="n">QREccLevel</span><span class="o">.</span><span class="n">H</span><span class="p">,</span>
        <span class="n">mask</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">data_entries</span><span class="o">=</span><span class="p">(</span>
            <span class="n">QrCodeData</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">QRDataType</span><span class="o">.</span><span class="n">KANJI</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;こんにちは世界&quot;</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">corners</span><span class="o">=</span><span class="p">((</span><span class="mi">17</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="mi">115</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="mi">116</span><span class="p">,</span> <span class="mi">116</span><span class="p">),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">115</span><span class="p">)),</span>
        <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">65</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">QRCode</span><span class="p">(</span>
        <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">ecc_level</span><span class="o">=</span><span class="n">QREccLevel</span><span class="o">.</span><span class="n">H</span><span class="p">,</span>
        <span class="n">mask</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">data_entries</span><span class="o">=</span><span class="p">(</span>
            <span class="n">QrCodeData</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">QRDataType</span><span class="o">.</span><span class="n">ALPHANUMERIC</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;HELLO WORLD&quot;</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">corners</span><span class="o">=</span><span class="p">((</span><span class="mi">181</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="mi">279</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">116</span><span class="p">),</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">115</span><span class="p">)),</span>
        <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">229</span><span class="p">,</span> <span class="mi">65</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">QRCode</span><span class="p">(</span>
        <span class="n">version</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">ecc_level</span><span class="o">=</span><span class="n">QREccLevel</span><span class="o">.</span><span class="n">H</span><span class="p">,</span>
        <span class="n">mask</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">data_entries</span><span class="o">=</span><span class="p">(</span>
            <span class="n">QrCodeData</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">QRDataType</span><span class="o">.</span><span class="n">BYTE</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s2">&quot;https://github.com/torque/deqr&quot;</span>
            <span class="p">),</span>
        <span class="p">),</span>
        <span class="n">corners</span><span class="o">=</span><span class="p">((</span><span class="mi">148</span><span class="p">,</span> <span class="mi">148</span><span class="p">),</span> <span class="p">(</span><span class="mi">279</span><span class="p">,</span> <span class="mi">148</span><span class="p">),</span> <span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">280</span><span class="p">),</span> <span class="p">(</span><span class="mi">148</span><span class="p">,</span> <span class="mi">279</span><span class="p">)),</span>
        <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">214</span><span class="p">,</span> <span class="mi">214</span><span class="p">)</span><span class="o">.</span>
    <span class="p">),</span>
    <span class="n">QRCode</span><span class="p">(</span>
        <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">ecc_level</span><span class="o">=</span><span class="n">QREccLevel</span><span class="o">.</span><span class="n">H</span><span class="p">,</span>
        <span class="n">mask</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">data_entries</span><span class="o">=</span><span class="p">(</span>
            <span class="n">QrCodeData</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">QRDataType</span><span class="o">.</span><span class="n">NUMERIC</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">925315282350536773542486064879</span>
            <span class="p">),</span>
        <span class="p">),</span>
        <span class="n">corners</span><span class="o">=</span><span class="p">((</span><span class="mi">17</span><span class="p">,</span> <span class="mi">181</span><span class="p">),</span> <span class="p">(</span><span class="mi">115</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="p">(</span><span class="mi">116</span><span class="p">,</span> <span class="mi">280</span><span class="p">),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">279</span><span class="p">)),</span>
        <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">229</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="visualizing-the-results">
<h3>Visualizing the Results<a class="headerlink" href="#visualizing-the-results" title="Permalink to this headline">#</a></h3>
<p>When trying to understand what the decoder is finding, it can be helpful to
annotate the source image using the information returned by the decoder. Here,
we show off the information we just decoded.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your source image is encoded as grayscale, you will not be able to draw
colored annotations on it without first converting it into a colorspace
with color channels. See the documentation of the annotation tool you are
using (e.g. <a class="reference external" href="https://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.Image.convert" title="(in Pillow (PIL Fork) v9.3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PIL.Image.Image.convert()</span></code></a>) for instruction on how to
accomplish that.</p>
</div>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">OpenCV</label><div class="tab-content docutils container">
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">QRdec</label><div class="tab-content docutils container">
<figure class="align-center">
<img alt="/deqr-docs/images/amalgam-annotated-opencv-qrdec.png" src="/deqr-docs/images/amalgam-annotated-opencv-qrdec.png" />
</figure>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_text</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">alignment</span><span class="p">):</span>
    <span class="n">font_face</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span>
    <span class="n">font_scale</span> <span class="o">=</span> <span class="mf">0.4</span>
    <span class="n">font_thickness</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">line_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span>

    <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="n">baseline</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span>
        <span class="n">text</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">font_scale</span><span class="p">,</span> <span class="n">fontFace</span><span class="o">=</span><span class="n">font_face</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">font_thickness</span>
    <span class="p">)</span>

    <span class="c1"># numpad-style alignment</span>
    <span class="n">alignment</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">location</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">width</span><span class="p">][</span><span class="n">alignment</span> <span class="o">%</span> <span class="mi">3</span><span class="p">],</span>
        <span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="n">baseline</span><span class="p">,</span> <span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">][</span><span class="n">alignment</span> <span class="o">//</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span>
        <span class="n">image</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">org</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
        <span class="n">fontFace</span><span class="o">=</span><span class="n">font_face</span><span class="p">,</span>
        <span class="n">fontScale</span><span class="o">=</span><span class="n">font_scale</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">thickness</span><span class="o">=</span><span class="n">font_thickness</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">lineType</span><span class="o">=</span><span class="n">line_type</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span>
        <span class="n">image</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">org</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
        <span class="n">fontFace</span><span class="o">=</span><span class="n">font_face</span><span class="p">,</span>
        <span class="n">fontScale</span><span class="o">=</span><span class="n">font_scale</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
        <span class="n">thickness</span><span class="o">=</span><span class="n">font_thickness</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">decoded_codes</span><span class="p">:</span>
    <span class="n">box_color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">polylines</span><span class="p">(</span>
        <span class="n">image_data</span><span class="p">,</span>
        <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)],</span>
        <span class="kc">True</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">box_color</span><span class="p">,</span>
        <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">box_color</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">box_color</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span>
        <span class="n">image_data</span><span class="p">,</span> <span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">thickness</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">FILLED</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">corner</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))):</span>
        <span class="n">draw_text</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">corner</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span>

    <span class="n">entry</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">data_entries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">draw_text</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">8</span><span class="p">)</span>


<span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;amalgam-annotated-opencv-qrdec.png&quot;</span><span class="p">,</span> <span class="n">image_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Quirc</label><div class="tab-content docutils container">
<figure class="align-center">
<img alt="/deqr-docs/images/amalgam-annotated-opencv-quirc.png" src="/deqr-docs/images/amalgam-annotated-opencv-quirc.png" />
</figure>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_text</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">alignment</span><span class="p">):</span>
    <span class="n">font_face</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span>
    <span class="n">font_scale</span> <span class="o">=</span> <span class="mf">0.4</span>
    <span class="n">font_thickness</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">line_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span>

    <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="n">baseline</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getTextSize</span><span class="p">(</span>
        <span class="n">text</span><span class="p">,</span> <span class="n">fontScale</span><span class="o">=</span><span class="n">font_scale</span><span class="p">,</span> <span class="n">fontFace</span><span class="o">=</span><span class="n">font_face</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">font_thickness</span>
    <span class="p">)</span>

    <span class="c1"># numpad-style alignment</span>
    <span class="n">alignment</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">location</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">width</span><span class="p">][</span><span class="n">alignment</span> <span class="o">%</span> <span class="mi">3</span><span class="p">],</span>
        <span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="n">baseline</span><span class="p">,</span> <span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">][</span><span class="n">alignment</span> <span class="o">//</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span>
        <span class="n">image</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">org</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
        <span class="n">fontFace</span><span class="o">=</span><span class="n">font_face</span><span class="p">,</span>
        <span class="n">fontScale</span><span class="o">=</span><span class="n">font_scale</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">thickness</span><span class="o">=</span><span class="n">font_thickness</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">lineType</span><span class="o">=</span><span class="n">line_type</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span>
        <span class="n">image</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">org</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
        <span class="n">fontFace</span><span class="o">=</span><span class="n">font_face</span><span class="p">,</span>
        <span class="n">fontScale</span><span class="o">=</span><span class="n">font_scale</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
        <span class="n">thickness</span><span class="o">=</span><span class="n">font_thickness</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">decoded_codes</span><span class="p">:</span>
    <span class="n">box_color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">polylines</span><span class="p">(</span>
        <span class="n">image_data</span><span class="p">,</span>
        <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)],</span>
        <span class="kc">True</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">box_color</span><span class="p">,</span>
        <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">box_color</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">box_color</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span>
        <span class="n">image_data</span><span class="p">,</span> <span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">thickness</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">FILLED</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">corner</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))):</span>
        <span class="n">draw_text</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">corner</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span>

    <span class="n">entry</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">data_entries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">draw_text</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">8</span><span class="p">)</span>


<span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;amalgam-annotated-opencv-quirc.png&quot;</span><span class="p">,</span> <span class="n">image_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Pillow</label><div class="tab-content docutils container">
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">QRdec</label><div class="tab-content docutils container">
<figure class="align-center">
<img alt="/deqr-docs/images/amalgam-annotated-pillow-qrdec.png" src="/deqr-docs/images/amalgam-annotated-pillow-qrdec.png" />
</figure>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">drawer</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>


<span class="n">font</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;Arial Unicode.ttf&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">decoded_codes</span><span class="p">:</span>
    <span class="n">box_color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">127</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>

    <span class="n">drawer</span><span class="o">.</span><span class="n">polygon</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">box_color</span><span class="p">)</span>

    <span class="n">drawer</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">fill</span><span class="o">=</span><span class="n">box_color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">drawer</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">fill</span><span class="o">=</span><span class="n">box_color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">drawer</span><span class="o">.</span><span class="n">ellipse</span><span class="p">(</span>
        <span class="p">(</span><span class="n">translate</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="n">translate</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
        <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">outline</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">corner</span><span class="p">,</span> <span class="n">anchor</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;lt&quot;</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;lb&quot;</span><span class="p">))):</span>
        <span class="n">drawer</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">corner</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span>
            <span class="n">anchor</span><span class="o">=</span><span class="n">anchor</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
            <span class="n">stroke_fill</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">stroke_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">entry</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">data_entries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">drawer</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;mt&quot;</span><span class="p">,</span>
    <span class="p">)</span>


<span class="n">image_data</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;amalgam-annotated-pillow-qrdec.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Quirc</label><div class="tab-content docutils container">
<figure class="align-center">
<img alt="/deqr-docs/images/amalgam-annotated-pillow-quirc.png" src="/deqr-docs/images/amalgam-annotated-pillow-quirc.png" />
</figure>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">drawer</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>


<span class="n">font</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;Arial Unicode.ttf&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">decoded_codes</span><span class="p">:</span>
    <span class="n">box_color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">127</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>

    <span class="n">drawer</span><span class="o">.</span><span class="n">polygon</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">box_color</span><span class="p">)</span>

    <span class="n">drawer</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">fill</span><span class="o">=</span><span class="n">box_color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">drawer</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">fill</span><span class="o">=</span><span class="n">box_color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">drawer</span><span class="o">.</span><span class="n">ellipse</span><span class="p">(</span>
        <span class="p">(</span><span class="n">translate</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="n">translate</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
        <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">outline</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">corner</span><span class="p">,</span> <span class="n">anchor</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;lt&quot;</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;lb&quot;</span><span class="p">))):</span>
        <span class="n">drawer</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">corner</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span>
            <span class="n">anchor</span><span class="o">=</span><span class="n">anchor</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
            <span class="n">stroke_fill</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">stroke_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">entry</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">data_entries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">drawer</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">code</span><span class="o">.</span><span class="n">corners</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;mt&quot;</span><span class="p">,</span>
    <span class="p">)</span>


<span class="n">image_data</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;amalgam-annotated-pillow-quirc.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="practical-usage">
<h2>Practical Usage<a class="headerlink" href="#practical-usage" title="Permalink to this headline">#</a></h2>
<p>QR codes were invented primarily to facilitate the process of transferring
information from real, physical objects into a computer system. As such, images
containing QR codes frequently have artifacts such as noise, blur, lens
distortion, uneven lighting, and offset perspective and rotation along with
other non-ideal characteristics that can impede the reliability of QR code
decoding.</p>
<p><code class="docutils literal notranslate"><span class="pre">deqr</span></code> ships with defaults that should perform reasonably well in real-world
scenarios.</p>
<section id="binarization">
<h3>Binarization<a class="headerlink" href="#binarization" title="Permalink to this headline">#</a></h3>
<p>Binarization is the process of converting all pixels in an image to either
completely white or completely black. Because the value of a QR code “bit” is
dependent on whether it is light or dark, this process makes a dramatic
difference in decoding rates in variable lighting conditions. The built-in
binarization conversion performs an adaptive threshold that binarizes the image
by comparing each pixel to a group of its neighbors. This approach compensates
for images that have poor or somewhat uneven lighting.</p>
</section>
<section id="demonstration">
<h3>Demonstration<a class="headerlink" href="#demonstration" title="Permalink to this headline">#</a></h3>
<p>Below are two examples of successfully decoded images. The first shows the
binarization dealing with poor lighting, and the second shows a somewhat blurry
image featuring some minor lens distortion. The outputs were generated using
the same scripts as the basic example above, with some minor modification to
preserve the binarization for demonstration purposes. These images also both
have the QR code rotated relative to its nominal orientation, illustrating that
the bounding box corner ordering follows the nominal QR code orientation rather
than the image orientation.</p>
<p>The inverted reflectance required by QRdec is also shown in the output.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Source</p></th>
<th class="head"><p>QRdec</p></th>
<th class="head"><p>Quirc</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><img alt="/deqr-docs/images/dark.jpg" src="/deqr-docs/images/dark.jpg" />
</td>
<td><img alt="/deqr-docs/images/dark-annotated-opencv-qrdec.jpg" src="/deqr-docs/images/dark-annotated-opencv-qrdec.jpg" />
</td>
<td><img alt="/deqr-docs/images/dark-annotated-opencv-quirc.jpg" src="/deqr-docs/images/dark-annotated-opencv-quirc.jpg" />
</td>
</tr>
<tr class="row-odd"><td><img alt="/deqr-docs/images/warped.jpg" src="/deqr-docs/images/warped.jpg" />
</td>
<td><img alt="/deqr-docs/images/warped-annotated-opencv-qrdec.jpg" src="/deqr-docs/images/warped-annotated-opencv-qrdec.jpg" />
</td>
<td><img alt="/deqr-docs/images/warped-annotated-opencv-quirc.jpg" src="/deqr-docs/images/warped-annotated-opencv-quirc.jpg" />
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="accessing-intermediates">
<h3>Accessing Intermediates<a class="headerlink" href="#accessing-intermediates" title="Permalink to this headline">#</a></h3>
<p>While not particularly recommended, here’s an example of accessing the
intermediate binarization image by (ab)using the fact that it is an in-place
mutation and that <a class="reference internal" href="api-reference.html#deqr.image.ImageLoader" title="deqr.image.ImageLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">deqr.image.ImageLoader</span></code></a> is passed through the decode
process without being copied.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">deqr</span>

<span class="n">image_data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;dark.jpg&quot;</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">deqr</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ImageLoader</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>

<span class="n">deqr</span><span class="o">.</span><span class="n">QRdecDecoder</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

<span class="n">reshaped</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="p">))</span>

<span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;dark-binarized.jpg&quot;</span><span class="p">,</span> <span class="n">reshaped</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="decoders.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Decoders</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Getting Started</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#a-basic-exmaple">A Basic Exmaple</a><ul>
<li><a class="reference internal" href="#decoding-from-an-image">Decoding From an Image</a></li>
<li><a class="reference internal" href="#visualizing-the-results">Visualizing the Results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#practical-usage">Practical Usage</a><ul>
<li><a class="reference internal" href="#binarization">Binarization</a></li>
<li><a class="reference internal" href="#demonstration">Demonstration</a></li>
<li><a class="reference internal" href="#accessing-intermediates">Accessing Intermediates</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabs.js"></script>
    </body>
</html>